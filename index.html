<!DOCTYPE html>
<html lang="en">
<head>
  <title>Bootstrap 5 Example</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  
</head>
<body>

<div class="container-fluid p-5 bg-primary text-white text-center">
  <h1>CSV Converter</h1>
</div>
  
<div class="container mt-5">
  <div class="row">
    <form action="/action_page.php">
	  <div class="mb-3 mt-3">
		<label for="csv" class="form-label">Selecciona archivo:</label>
		<input required type="file" class="form-control" id="csv" placeholder="Seleccione archivo csv:" name="csv">
	  </div>
	  <div class="mb-3">
		<label for="name" class="form-label">Nombre archivo exportado:</label>
		<input required type="text" class="form-control" id="name" placeholder="Introduce nombre de archivo a exportar" name="name">
	  </div>
	  <button type="submit" onclick="aTag.click();" class="btn btn-primary" id="conv_btn">Convertir</button>
	</form>
  </div>
</div>
<script type="module">
		window.onload = async () => {

			let cvrt = await import('./src/Csv2Xlsx.js');

			// Meta-Data of the xlsx
			const metaData = {
				title: 'My Demo Spreadsheet',
				subject: 'A Demo for CSV to XLSX',
				creator: 'John Doe',
				company: 'Super Doe Ltd.',
				lastModifiedBy: 'John Doe',
				created: new Date(2020, 0, 1, 11, 21),
				modified: null // now
			};

			var file = document.getElementById('csv');
			var new_file = document.getElementById('name').value;
			console.log(file);
			console.log(new_file);

			// download the csv and convert it to a excel file
			let aTag = await cvrt.Csv2Xlsx.convertCsv(file, null, metaData, 'UTF-8', updateState);
		};

	</script>
</body>
</html>






